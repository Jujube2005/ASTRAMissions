<div class="mission-manager-page">
    <div class="manager-container">

        <!-- HEADER SECTION -->
        <header class="manager-header">
            <div class="title-group">
                <p>Strategic Intelligence</p>
                <h1>Mission Control</h1>
            </div>

            <button class="new-mission-btn" (click)="openDialog()">
                <span class="material-symbols-outlined">add_circle</span>
                <span>Initialize Protocol</span>
            </button>
        </header>

        <!-- MISSIONS LIST -->
        <div class="mission-manager-list floating-container">
            <!-- Table Header -->
            @if((myMissions$ | async)?.length) {
            <div class="header-row">
                <span>Protocol Name</span>
                <span>Access Level</span>
                <span>Operative</span>
                <span>Briefing</span>
                <span>Sector</span>
                <span>Unit Capacity</span>
                <span>Status</span>
                <span></span>
            </div>

            <div class="mission-rows-container">
                @for (mission of myMissions$ | async; track mission.id) {
                <div class="mission-row group" (click)="navigateToMission(mission.id)">

                    <!-- Name & Alert -->
                    <div class="name-cell">
                        @if (hasJoinAlert(mission.id)) {
                        <div class="alert-dot" title="New deployment request"></div>
                        }
                        <span class="mission-name">{{mission.name}}</span>
                    </div>

                    <!-- Role -->
                    <div class="role-cell">
                        <span class="role-badge" [class.chief]="mission.chief_id === (passport.userId())"
                            [class.member]="mission.chief_id !== (passport.userId())">
                            {{mission.chief_id === (passport.userId()) ? 'CHIEF' : 'MEMBER'}}
                        </span>
                    </div>

                    <!-- Chief Name -->
                    <div class="chief-cell">
                        {{mission.chief_display_name}}
                    </div>

                    <!-- Description -->
                    <div class="desc-cell">
                        {{mission.description || 'No classified intelligence available.'}}
                    </div>

                    <!-- Category -->
                    <div class="category-cell">
                        <span class="category-badge">{{mission.category || 'General'}}</span>
                    </div>

                    <!-- Crew Count -->
                    <div class="crew-cell">
                        {{mission.crew_count}} / {{mission.max_crew || 5}}
                    </div>

                    <!-- Status -->
                    <div class="status-cell">
                        <span class="status-badge" [class]="mission.status">
                            {{mission.status}}
                        </span>
                    </div>

                    <!-- Action Icon -->
                    <div class="action-cell">
                        <span class="material-symbols-outlined">chevron_right</span>
                    </div>
                </div>
                }
            </div>
            } @else {
            <div class="p-20 text-center">
                <span class="material-symbols-outlined text-6xl text-slate-800 mb-4">leaderboard</span>
                <p class="text-slate-500 font-bold uppercase tracking-widest">No active deployments found.</p>
            </div>
            }
        </div>
    </div>
</div>